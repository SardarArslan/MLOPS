schema: '2.0'
stages:
  prepare:
    cmd: uv run src/train/prepare.py
    deps:
    - path: data/green_tripdata_2025-01.parquet
      hash: md5
      md5: 110776612e1b020e9c4a0e41f16da597
      size: 1178451
    - path: data/green_tripdata_2025-02.parquet
      hash: md5
      md5: 285ba83969404f0be70cf6ae250e394b
      size: 1117474
    - path: src/train/prepare.py
      hash: md5
      md5: fc5c5f70a26ac76b1aa046495a5ce023
      size: 2943
    outs:
    - path: data/processed/X_train.pkl
      hash: md5
      md5: c382c4e50680c739bab10e27cf804a02
      size: 1297007
    - path: data/processed/X_val.pkl
      hash: md5
      md5: 510a9c0f801cd3354bd9535bffc3cc6c
      size: 1211131
    - path: data/processed/data_stats.json
      hash: md5
      md5: 77891e1cdfedc092c52d2a92161cbc30
      size: 249
    - path: data/processed/dv.pkl
      hash: md5
      md5: 28ee534f3c23d89b36b2781cbbc4b0c4
      size: 95281
    - path: data/processed/y_train.pkl
      hash: md5
      md5: fdf4fc43c02fcb091ee6ab09c7d4ba46
      size: 370617
    - path: data/processed/y_val.pkl
      hash: md5
      md5: 17b7f5c9482fa3328493709b03e0c495
      size: 353905
  train:
    cmd: uv run python -m src.train
    deps:
    - path: data/processed/churn_cleaned.csv
      hash: md5
      md5: 888aa4e61e4941125b9c4cf491282ece
      size: 441988
    - path: src/train.py
      hash: md5
      md5: 1620d49f2c5ab12d72b6050b6fcf772c
      size: 2515
    params:
      config/params.yaml:
        model_selection.threshold: 0.3
        train:
          n_estimators: 250
          max_depth: 25
          class_weight: balanced
  preprocess:
    cmd: uv run python -m src.preprocess
    deps:
    - path: data/raw/churn.csv
      hash: md5
      md5: 17079a290f091dcebf9a1c46c3b67297
      size: 604824
    - path: src/preprocess.py
      hash: md5
      md5: feeb83fab58612fd6d2a90c215adf55e
      size: 1139
    outs:
    - path: data/processed/churn_cleaned.csv
      hash: md5
      md5: 888aa4e61e4941125b9c4cf491282ece
      size: 441988
  fetch_data:
    cmd: uv run python -m src.fetch_data
    deps:
    - path: src/fetch_data.py
      hash: md5
      md5: e51e94d84a60fe1d7eb63a9f0301a228
      size: 5855
