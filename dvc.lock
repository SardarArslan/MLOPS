schema: '2.0'
stages:
  prepare:
    cmd: uv run src/train/prepare.py
    deps:
    - path: data/green_tripdata_2025-01.parquet
      hash: md5
      md5: 110776612e1b020e9c4a0e41f16da597
      size: 1178451
    - path: data/green_tripdata_2025-02.parquet
      hash: md5
      md5: 285ba83969404f0be70cf6ae250e394b
      size: 1117474
    - path: src/train/prepare.py
      hash: md5
      md5: fc5c5f70a26ac76b1aa046495a5ce023
      size: 2943
    outs:
    - path: data/processed/X_train.pkl
      hash: md5
      md5: c382c4e50680c739bab10e27cf804a02
      size: 1297007
    - path: data/processed/X_val.pkl
      hash: md5
      md5: 510a9c0f801cd3354bd9535bffc3cc6c
      size: 1211131
    - path: data/processed/data_stats.json
      hash: md5
      md5: 77891e1cdfedc092c52d2a92161cbc30
      size: 249
    - path: data/processed/dv.pkl
      hash: md5
      md5: 28ee534f3c23d89b36b2781cbbc4b0c4
      size: 95281
    - path: data/processed/y_train.pkl
      hash: md5
      md5: fdf4fc43c02fcb091ee6ab09c7d4ba46
      size: 370617
    - path: data/processed/y_val.pkl
      hash: md5
      md5: 17b7f5c9482fa3328493709b03e0c495
      size: 353905
  train:
    cmd: python src/train.py
    deps:
    - path: data/processed/churn_cleaned.csv
      hash: md5
      md5: b45487c3d375bcd6ccebbee6e0b8f2e8
      size: 290603
    - path: src/train.py
      hash: md5
      md5: 15cde3434aaf62936a1316250878bd9c
      size: 2438
    params:
      params.yaml:
        model_selection.threshold: 0.3
        train:
          n_estimators: 250
          max_depth: 25
          class_weight: balanced
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: data/raw/churn.csv
      hash: md5
      md5: a18208815bed03bf85f9d8e539978217
      size: 402937
    - path: src/preprocess.py
      hash: md5
      md5: 94f7391e02645561497417779953ab94
      size: 1064
    outs:
    - path: data/processed/churn_cleaned.csv
      hash: md5
      md5: b45487c3d375bcd6ccebbee6e0b8f2e8
      size: 290603
  fetch_data:
    cmd: uv run python src/fetch_data.py
    deps:
    - path: src/fetch_data.py
      hash: md5
      md5: daee2212684d0aad5edab91460a56f40
      size: 5875
