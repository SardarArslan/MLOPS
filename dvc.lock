schema: '2.0'
stages:
  prepare:
    cmd: uv run src/train/prepare.py
    deps:
    - path: data/green_tripdata_2025-01.parquet
      hash: md5
      md5: 110776612e1b020e9c4a0e41f16da597
      size: 1178451
    - path: data/green_tripdata_2025-02.parquet
      hash: md5
      md5: 285ba83969404f0be70cf6ae250e394b
      size: 1117474
    - path: src/train/prepare.py
      hash: md5
      md5: fc5c5f70a26ac76b1aa046495a5ce023
      size: 2943
    outs:
    - path: data/processed/X_train.pkl
      hash: md5
      md5: c382c4e50680c739bab10e27cf804a02
      size: 1297007
    - path: data/processed/X_val.pkl
      hash: md5
      md5: 510a9c0f801cd3354bd9535bffc3cc6c
      size: 1211131
    - path: data/processed/data_stats.json
      hash: md5
      md5: 77891e1cdfedc092c52d2a92161cbc30
      size: 249
    - path: data/processed/dv.pkl
      hash: md5
      md5: 28ee534f3c23d89b36b2781cbbc4b0c4
      size: 95281
    - path: data/processed/y_train.pkl
      hash: md5
      md5: fdf4fc43c02fcb091ee6ab09c7d4ba46
      size: 370617
    - path: data/processed/y_val.pkl
      hash: md5
      md5: 17b7f5c9482fa3328493709b03e0c495
      size: 353905
  train:
    cmd: python src/train.py
    deps:
    - path: data/processed/churn_cleaned.csv
      hash: md5
      md5: 188b61c35036f2a0fd877f1cbef248c0
      size: 10615
    - path: src/train.py
      hash: md5
      md5: 6f055f67666e69150288e22446869389
      size: 2421
    params:
      params.yaml:
        model_selection.threshold: 0.3
        train:
          n_estimators: 250
          max_depth: 25
          class_weight: balanced
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: data/raw/churn.csv
      hash: md5
      md5: 7abf27e693bd30772f5eca1fd64e91de
      size: 20000
    - path: src/preprocess.py
      hash: md5
      md5: 7f60bba89b8336bcd1345947684ae613
      size: 1080
    outs:
    - path: data/processed/churn_cleaned.csv
      hash: md5
      md5: 188b61c35036f2a0fd877f1cbef248c0
      size: 10615
  fetch_data:
    cmd: uv run python src/fetch_data.py
    deps:
    - path: src/fetch_data.py
      hash: md5
      md5: 72f1eebe2389c62a7e57b982e95ff13d
      size: 604
